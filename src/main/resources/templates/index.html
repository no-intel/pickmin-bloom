<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/lib/openlayers/ol.css">
    <style>
        html,
        body {
            margin: 0;
            height: 100%;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
    <title>Quick Start</title>
</head>
<body>
<div id="map"></div>

<script src="/lib/openlayers/dist/ol.js"></script>
<script>
    const getCurrentLocation = async () => {
        if (!navigator.geolocation) {
            console.warn("Geolocation은 이 브라우저에서 지원되지 않습니다. 기본 좌표를 사용합니다.");
            return { latitude: 0, longitude: 0 };
        }
        return new Promise((resolve) => {
            navigator.geolocation.getCurrentPosition(
                ({ coords: { latitude, longitude } }) => resolve({ latitude, longitude }),
                () => {
                    console.warn("위치 정보를 가져오는 데 실패했습니다. 기본 좌표를 사용합니다.");
                    resolve({ latitude: 0, longitude: 0 });
                }
            );
        });
    };

    const initMap = async () => {
        const { latitude, longitude } = await getCurrentLocation();
        console.log(latitude, longitude);

        const view = new ol.View({
            center: ol.proj.fromLonLat([longitude, latitude]),
            zoom: 16,
        });

        return new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM(),
                })
            ],
            view: view,
        });
    };


    initMap();

</script>

</body>
</html>
